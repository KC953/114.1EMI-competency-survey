<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EMI 學生素養分層分析儀表板</title>
    <!-- 載入庫：React, Recharts, Tailwind -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>
    <script src="https://unpkg.com/recharts@2.12.0/umd/Recharts.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 使用穩定版本圖標庫 -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { background-color: #f9fafb; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }
        .bg-stats-bar { height: 54px; border-radius: 27px; overflow: hidden; display: flex; align-items: center; background-color: #f3f4f6; border: 1px solid #e5e7eb; }
        .bg-stats-segment { height: 100%; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: 1000; color: white; transition: width 1s ease-in-out; text-shadow: 0px 1px 3px rgba(0,0,0,0.3); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { 
            BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer,
            Radar, RadarChart, PolarGrid, PolarAngleAxis, PolarRadiusAxis,
            Cell, ComposedChart, Line, LabelList
        } = window.Recharts;

        const SimpleIcon = ({ name, color = "#666", size = 20 }) => {
            const icons = {
                users: `<path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/>`,
                globe: `<circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20"/><path d="M2 12h20"/><path d="M12 2a14.5 14.5 0 0 1 0 20"/><path d="M3.6 9h16.8"/><path d="M3.6 15h16.8"/>`,
                smile: `<circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/>`,
                venusmars: `<path d="M12 2v10"/><path d="M12 12c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6z"/><path d="M12 18c-3.3 0-6 2.7-6 6v2h12v-2c0-3.3-2.7-6-6-6z"/>`,
                target: `<circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/>`,
                book: `<path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1-0.5-5"/><path d="M6.5 17.5c-1.38 0-2.5 1.12-2.5 2.5"/>`,
                brain: `<path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.78-3.06 2.5 2.5 0 0 1-2.12-4.16 2.5 2.5 0 0 1-.14-4.78 2.5 2.5 0 0 1 2.5-3.94A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.78-3.06 2.5 2.5 0 0 0 2.12-4.16 2.5 2.5 0 0 0 .14-4.78 2.5 2.5 0 0 0-2.5-3.94A2.5 2.5 0 0 0 14.5 2Z"/>`,
                zap: `<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>`,
                star: `<polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>`
            };
            return (
                <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke={color} strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" 
                     dangerouslySetInnerHTML={{ __html: icons[name] || "" }} />
            );
        };

        const apiKey = ""; 

        const COLLEGE_DATASET = {
            'Overall (全校整體)': {
                count: 3340,
                topKpis: [
                    { label: '有效問卷總數', val: '3,340', icon: 'users', color: '#8697A8' },
                    { label: '海外讀書/工作意願', val: '2,871', icon: 'globe', color: '#C49B9B', sub: '占比: 86.0%' },
                    { label: 'EMI 增加出國信心', val: '2,405', icon: 'smile', color: '#9F97B5', sub: '占比: 72.0%' },
                    { label: '性別分布 (女/男)', val: '1,101 / 2,239', icon: 'venusmars', color: '#64748b' }
                ],
                dimensionKpis: [
                    { label: '自我調節學習', val: '3.8', icon: 'target', color: '#8697A8' },
                    { label: '學術英語&學科學習', val: '3.6', icon: 'book', color: '#C49B9B' },
                    { label: 'Bloom認知', val: '3.8', icon: 'brain', color: '#9F97B5' },
                    { label: '課程參與', val: '3.7', icon: 'zap', color: '#C49B9B' },
                    { label: '自我效能', val: '3.8', icon: 'star', color: '#8697A8' }
                ],
                bgStats: [{ label: '生理性別 (女性/男性)', val: 1101, total: 3340, posLabel: '女性', negLabel: '男性' }, { label: '這是第一次修 EMI (是/否)', val: 1365, total: 3340, posLabel: '是', negLabel: '否' }, { label: 'EMI 增加出國信心 (是/否)', val: 2405, total: 3340, posLabel: '是', negLabel: '否' }, { label: '有意願海外讀書工作 (是/否)', val: 2871, total: 3340, posLabel: '是', negLabel: '否' }],
                ratio: [{ name: '教師講授', value: 44 }, { name: '師生互動', value: 21 }, { name: '生生互動', value: 16 }, { name: '學生報告', value: 15 }, { name: '其他', value: 14 }],
                itemScores: [{ name: 'SRL1', score: 3.8 }, { name: 'SRL2', score: 3.3 }, { name: 'SRL3', score: 3.8 }, { name: 'SRL4', score: 4.0 }, { name: 'SRL5', score: 4.0 }, { name: 'CALP1', score: 3.6 }, { name: 'CALP2', score: 3.6 }, { name: 'CALP3', score: 3.5 }, { name: 'CALP4', score: 3.5 }, { name: 'CALP5', score: 3.6 }, { name: 'CALP6', score: 3.5 }, { name: 'Cog1', score: 3.9 }, { name: 'Cog2', score: 3.8 }, { name: 'Cog3', score: 3.8 }, { name: 'Cog4', score: 3.8 }, { name: 'Cog5', score: 3.8 }, { name: 'Cog6', score: 3.7 }, { name: 'Eng1', score: 3.8 }, { name: 'Eng2', score: 3.8 }, { name: 'Eng3', score: 3.8 }, { name: 'Eng4', score: 3.3 }, { name: 'Eng5', score: 3.6 }, { name: 'Eng6', score: 3.7 }, { name: 'Eng7', score: 3.7 }, { name: 'SE1', score: 3.8 }, { name: 'SE2', score: 3.8 }, { name: 'SE3', score: 3.7 }, { name: 'SE4', score: 3.8 }, { name: 'SE5', score: 3.7 }, { name: 'SE6', score: 3.8 }]
            },
            '工程學院': {
                count: 850,
                topKpis: [
                    { label: '有效問卷總數', val: '850', icon: 'users', color: '#8697A8' },
                    { label: '海外讀書/工作意願', val: '745', icon: 'globe', color: '#C49B9B', sub: '占比: 87.6%' },
                    { label: 'EMI 增加出國信心', val: '634', icon: 'smile', color: '#9F97B5', sub: '占比: 74.6%' },
                    { label: '性別分布 (女/男)', val: '217 / 633', icon: 'venusmars', color: '#64748b' }
                ],
                dimensionKpis: [
                    { label: '自我調節學習', val: '3.8', icon: 'target', color: '#8697A8' },
                    { label: '學術英語&學科學習', val: '3.6', icon: 'book', color: '#C49B9B' },
                    { label: 'Bloom認知', val: '3.8', icon: 'brain', color: '#9F97B5' },
                    { label: '課程參與', val: '3.7', icon: 'zap', color: '#C49B9B' },
                    { label: '自我效能', val: '3.8', icon: 'star', color: '#8697A8' }
                ],
                bgStats: [{ label: '生理性別 (女性/男性)', val: 217, total: 850, posLabel: '女性', negLabel: '男性' }, { label: '這是第一次修 EMI (是/否)', val: 311, total: 850, posLabel: '是', negLabel: '否' }, { label: 'EMI 增加出國信心 (是/否)', val: 634, total: 850, posLabel: '是', negLabel: '否' }, { label: '有意願海外讀書工作 (是/否)', val: 745, total: 850, posLabel: '是', negLabel: '否' }],
                ratio: [{ name: '教師講授', value: 47 }, { name: '師生互動', value: 21 }, { name: '生生互動', value: 15 }, { name: '學生報告', value: 13 }, { name: '其他', value: 15 }],
                itemScores: [{ name: 'SRL1', score: 3.8 }, { name: 'SRL2', score: 3.3 }, { name: 'SRL3', score: 3.8 }, { name: 'SRL4', score: 3.9 }, { name: 'SRL5', score: 4.0 }, { name: 'CALP1', score: 3.7 }, { name: 'CALP2', score: 3.6 }, { name: 'CALP3', score: 3.5 }, { name: 'CALP4', score: 3.5 }, { name: 'CALP5', score: 3.7 }, { name: 'CALP6', score: 3.6 }, { name: 'Cog1', score: 3.9 }, { name: 'Cog2', score: 3.8 }, { name: 'Cog3', score: 3.8 }, { name: 'Cog4', score: 3.8 }, { name: 'Cog5', score: 3.8 }, { name: 'Cog6', score: 3.6 }, { name: 'Eng1', score: 3.8 }, { name: 'Eng2', score: 3.9 }, { name: 'Eng3', score: 3.8 }, { name: 'Eng4', score: 3.3 }, { name: 'Eng5', score: 3.5 }, { name: 'Eng6', score: 3.7 }, { name: 'Eng7', score: 3.7 }, { name: 'SE1', score: 3.9 }, { name: 'SE2', score: 3.8 }, { name: 'SE3', score: 3.7 }, { name: 'SE4', score: 3.9 }, { name: 'SE5', score: 3.7 }, { name: 'SE6', score: 3.8 }]
            },
            '電資學院': {
                count: 1363,
                topKpis: [
                    { label: '有效問卷總數', val: '1,363', icon: 'users', color: '#8697A8' },
                    { label: '海外讀書/工作意願', val: '1,095', icon: 'globe', color: '#C49B9B', sub: '占比: 80.3%' },
                    { label: 'EMI 增加出國信心', val: '861', icon: 'smile', color: '#9F97B5', sub: '占比: 63.2%' },
                    { label: '性別分布 (女/男)', val: '215 / 1,148', icon: 'venusmars', color: '#64748b' }
                ],
                dimensionKpis: [
                    { label: '自我調節學習', val: '3.8', icon: 'target', color: '#8697A8' },
                    { label: '學術英語&學科學習', val: '3.3', icon: 'book', color: '#C49B9B' },
                    { label: 'Bloom認知', val: '3.7', icon: 'brain', color: '#9F97B5' },
                    { label: '課程參與', val: '3.5', icon: 'zap', color: '#C49B9B' },
                    { label: '自我效能', val: '3.6', icon: 'star', color: '#8697A8' }
                ],
                bgStats: [{ label: '生理性別 (女性/男性)', val: 215, total: 1363, posLabel: '女性', negLabel: '男性' }, { label: '這是第一次修 EMI (是/否)', val: 710, total: 1363, posLabel: '是', negLabel: '否' }, { label: 'EMI 增加出國信心 (是/否)', val: 861, total: 1363, posLabel: '是', negLabel: '否' }, { label: '有意願海外讀書工作 (是/否)', val: 1095, total: 1363, posLabel: '是', negLabel: '否' }],
                ratio: [{ name: '教師講授', value: 49 }, { name: '師生互動', value: 19 }, { name: '生生互動', value: 13 }, { name: '學生報告', value: 11 }, { name: '其他', value: 13 }],
                itemScores: [{ name: 'SRL1', score: 3.8 }, { name: 'SRL2', score: 3.2 }, { name: 'SRL3', score: 3.8 }, { name: 'SRL4', score: 4.0 }, { name: 'SRL5', score: 4.0 }, { name: 'CALP1', score: 3.3 }, { name: 'CALP2', score: 3.3 }, { name: 'CALP3', score: 3.2 }, { name: 'CALP4', score: 3.2 }, { name: 'CALP5', score: 3.4 }, { name: 'CALP6', score: 3.3 }, { name: 'Cog1', score: 3.8 }, { name: 'Cog2', score: 3.7 }, { name: 'Cog3', score: 3.7 }, { name: 'Cog4', score: 3.7 }, { name: 'Cog5', score: 3.7 }, { name: 'Cog6', score: 3.5 }, { name: 'Eng1', score: 3.6 }, { name: 'Eng2', score: 3.7 }, { name: 'Eng3', score: 3.6 }, { name: 'Eng4', score: 3.3 }, { name: 'Eng5', score: 3.4 }, { name: 'Eng6', score: 3.6 }, { name: 'Eng7', score: 3.6 }, { name: 'SE1', score: 3.7 }, { name: 'SE2', score: 3.6 }, { name: 'SE3', score: 3.5 }, { name: 'SE4', score: 3.7 }, { name: 'SE5', score: 3.5 }, { name: 'SE6', score: 3.6 }]
            },
            '管理學院': {
                count: 442,
                topKpis: [
                    { label: '有效問卷總數', val: '442', icon: 'users', color: '#8697A8' },
                    { label: '海外讀書/工作意願', val: '405', icon: 'globe', color: '#C49B9B', sub: '占比: 91.6%' },
                    { label: 'EMI 增加出國信心', val: '348', icon: 'smile', color: '#9F97B5', sub: '占比: 78.7%' },
                    { label: '性別分布 (女/男)', val: '244 / 198', icon: 'venusmars', color: '#64748b' }
                ],
                dimensionKpis: [
                    { label: '自我調節學習', val: '3.9', icon: 'target', color: '#8697A8' },
                    { label: '學術英語&學科學習', val: '3.8', icon: 'book', color: '#C49B9B' },
                    { label: 'Bloom認知', val: '4.0', icon: 'brain', color: '#9F97B5' },
                    { label: '課程參與', val: '3.8', icon: 'zap', color: '#C49B9B' },
                    { label: '自我效能', val: '4.0', icon: 'star', color: '#8697A8' }
                ],
                bgStats: [{ label: '生理性別 (女性/男性)', val: 244, total: 442, posLabel: '女性', negLabel: '男性' }, { label: '這是第一次修 EMI (是/否)', val: 149, total: 442, posLabel: '是', negLabel: '否' }, { label: 'EMI 增加出國信心 (是/否)', val: 348, total: 442, posLabel: '是', negLabel: '否' }, { label: '有意願海外讀書工作 (是/否)', val: 405, total: 442, posLabel: '是', negLabel: '否' }],
                ratio: [{ name: '教師講授', value: 38 }, { name: '師生互動', value: 21 }, { name: '生生互動', value: 19 }, { name: '學生報告', value: 21 }, { name: '其他', value: 14 }],
                itemScores: [{ name: 'SRL1', score: 3.9 }, { name: 'SRL2', score: 3.4 }, { name: 'SRL3', score: 3.9 }, { name: 'SRL4', score: 4.1 }, { name: 'SRL5', score: 4.1 }, { name: 'CALP1', score: 3.8 }, { name: 'CALP2', score: 3.8 }, { name: 'CALP3', score: 3.7 }, { name: 'CALP4', score: 3.7 }, { name: 'CALP5', score: 3.9 }, { name: 'CALP6', score: 3.8 }, { name: 'Cog1', score: 4.0 }, { name: 'Cog2', score: 4.0 }, { name: 'Cog3', score: 3.9 }, { name: 'Cog4', score: 3.9 }, { name: 'Cog5', score: 4.0 }, { name: 'Cog6', score: 3.9 }, { name: 'Eng1', score: 3.9 }, { name: 'Eng2', score: 4.0 }, { name: 'Eng3', score: 3.9 }, { name: 'Eng4', score: 3.3 }, { name: 'Eng5', score: 3.8 }, { name: 'Eng6', score: 3.9 }, { name: 'Eng7', score: 3.8 }, { name: 'SE1', score: 4.0 }, { name: 'SE2', score: 4.0 }, { name: 'SE3', score: 4.0 }, { name: 'SE4', score: 4.1 }, { name: 'SE5', score: 3.9 }, { name: 'SE6', score: 4.0 }]
            },
            '應科學院': {
                count: 82,
                topKpis: [
                    { label: '有效問卷總數', val: '82', icon: 'users', color: '#8697A8' },
                    { label: '海外讀書/工作意願', val: '67', icon: 'globe', color: '#C49B9B', sub: '占比: 81.7%' },
                    { label: 'EMI 增加出國信心', val: '64', icon: 'smile', color: '#9F97B5', sub: '占比: 78.0%' },
                    { label: '性別分布 (女/男)', val: '36 / 46', icon: 'venusmars', color: '#64748b' }
                ],
                dimensionKpis: [
                    { label: '自我調節學習', val: '3.8', icon: 'target', color: '#8697A8' },
                    { label: '學術英語&學科學習', val: '3.8', icon: 'book', color: '#C49B9B' },
                    { label: 'Bloom認知', val: '3.9', icon: 'brain', color: '#9F97B5' },
                    { label: '課程參與', val: '3.9', icon: 'zap', color: '#C49B9B' },
                    { label: '自我效能', val: '3.9', icon: 'star', color: '#8697A8' }
                ],
                bgStats: [{ label: '生理性別 (女性/男性)', val: 36, total: 82, posLabel: '女性', negLabel: '男性' }, { label: '這是第一次修 EMI (是/否)', val: 38, total: 82, posLabel: '是', negLabel: '否' }, { label: 'EMI 增加出國信心 (是/否)', val: 64, total: 82, posLabel: '是', negLabel: '否' }, { label: '有意願海外讀書工作 (是/否)', val: 67, total: 82, posLabel: '是', negLabel: '否' }],
                ratio: [{ name: '教師講授', value: 36 }, { name: '師生互動', value: 25 }, { name: '生生互動', value: 22 }, { name: '學生報告', value: 25 }, { name: '其他', value: 18 }],
                itemScores: [{ name: 'SRL1', score: 3.8 }, { name: 'SRL2', score: 3.6 }, { name: 'SRL3', score: 3.9 }, { name: 'SRL4', score: 3.9 }, { name: 'SRL5', score: 4.0 }, { name: 'CALP1', score: 3.9 }, { name: 'CALP2', score: 3.8 }, { name: 'CALP3', score: 3.8 }, { name: 'CALP4', score: 3.7 }, { name: 'CALP5', score: 3.8 }, { name: 'CALP6', score: 3.8 }, { name: 'Cog1', score: 4.0 }, { name: 'Cog2', score: 3.9 }, { name: 'Cog3', score: 3.9 }, { name: 'Cog4', score: 3.9 }, { name: 'Cog5', score: 3.9 }, { name: 'Cog6', score: 3.9 }, { name: 'Eng1', score: 4.1 }, { name: 'Eng2', score: 4.1 }, { name: 'Eng3', score: 4.0 }, { name: 'Eng4', score: 3.6 }, { name: 'Eng5', score: 3.8 }, { name: 'Eng6', score: 4.0 }, { name: 'Eng7', score: 3.9 }, { name: 'SE1', score: 4.0 }, { name: 'SE2', score: 4.0 }, { name: 'SE3', score: 3.7 }, { name: 'SE4', score: 4.0 }, { name: 'SE5', score: 4.0 }, { name: 'SE6', score: 3.9 }]
            },
            '設計學院': {
                count: 38,
                topKpis: [
                    { label: '有效問卷總數', val: '38', icon: 'users', color: '#8697A8' },
                    { label: '海外讀書/工作意願', val: '35', icon: 'globe', color: '#C49B9B', sub: '占比: 92.1%' },
                    { label: 'EMI 增加出國信心', val: '30', icon: 'smile', color: '#9F97B5', sub: '占比: 78.9%' },
                    { label: '性別分布 (女/男)', val: '21 / 17', icon: 'venusmars', color: '#64748b' }
                ],
                dimensionKpis: [
                    { label: '自我調節學習', val: '3.8', icon: 'target', color: '#8697A8' },
                    { label: '學術英語&學科學習', val: '3.7', icon: 'book', color: '#C49B9B' },
                    { label: 'Bloom認知', val: '3.9', icon: 'brain', color: '#9F97B5' },
                    { label: '課程參與', val: '3.8', icon: 'zap', color: '#C49B9B' },
                    { label: '自我效能', val: '3.7', icon: 'star', color: '#8697A8' }
                ],
                bgStats: [{ label: '生理性別 (女性/男性)', val: 21, total: 38, posLabel: '女性', negLabel: '男性' }, { label: '這是第一次修 EMI (是/否)', val: 16, total: 38, posLabel: '是', negLabel: '否' }, { label: 'EMI 增加出國信心 (是/否)', val: 30, total: 38, posLabel: '是', negLabel: '否' }, { label: '有意願海外讀書工作 (是/否)', val: 35, total: 38, posLabel: '是', negLabel: '否' }],
                ratio: [{ name: '教師講授', value: 34 }, { name: '師生互動', value: 27 }, { name: '生生互動', value: 21 }, { name: '學生報告', value: 16 }, { name: '其他', value: 20 }],
                itemScores: [{ name: 'SRL1', score: 3.8 }, { name: 'SRL2', score: 3.2 }, { name: 'SRL3', score: 3.7 }, { name: 'SRL4', score: 4.1 }, { name: 'SRL5', score: 3.9 }, { name: 'CALP1', score: 3.7 }, { name: 'CALP2', score: 3.8 }, { name: 'CALP3', score: 3.7 }, { name: 'CALP4', score: 3.5 }, { name: 'CALP5', score: 3.7 }, { name: 'CALP6', score: 3.7 }, { name: 'Cog1', score: 3.8 }, { name: 'Cog2', score: 3.8 }, { name: 'Cog3', score: 3.9 }, { name: 'Cog4', score: 4.0 }, { name: 'Cog5', score: 3.9 }, { name: 'Cog6', score: 4.0 }, { name: 'Eng1', score: 3.9 }, { name: 'Eng2', score: 3.9 }, { name: 'Eng3', score: 4.0 }, { name: 'Eng4', score: 3.2 }, { name: 'Eng5', score: 3.6 }, { name: 'Eng6', score: 3.9 }, { name: 'Eng7', score: 3.8 }, { name: 'SE1', score: 3.6 }, { name: 'SE2', score: 3.6 }, { name: 'SE3', score: 3.7 }, { name: 'SE4', score: 3.8 }, { name: 'SE5', score: 3.7 }, { name: 'SE6', score: 3.9 }]
            },
            '人文學院': {
                count: 471,
                topKpis: [
                    { label: '有效問卷總數', val: '471', icon: 'users', color: '#8697A8' },
                    { label: '海外讀書/工作意願', val: '441', icon: 'globe', color: '#C49B9B', sub: '占比: 93.6%' },
                    { label: 'EMI 增加出國信心', val: '395', icon: 'smile', color: '#9F97B5', sub: '占比: 83.9%' },
                    { label: '性別分布 (女/男)', val: '333 / 138', icon: 'venusmars', color: '#64748b' }
                ],
                dimensionKpis: [
                    { label: '自我調節學習', val: '3.8', icon: 'target', color: '#8697A8' },
                    { label: '學術英語&學科學習', val: '4.0', icon: 'book', color: '#C49B9B' },
                    { label: 'Bloom認知', val: '4.0', icon: 'brain', color: '#9F97B5' },
                    { label: '課程參與', val: '3.8', icon: 'zap', color: '#C49B9B' },
                    { label: '自我效能', val: '4.0', icon: 'star', color: '#8697A8' }
                ],
                bgStats: [{ label: '生理性別 (女性/男性)', val: 333, total: 471, posLabel: '女性', negLabel: '男性' }, { label: '這是第一次修 EMI (是/否)', val: 104, total: 471, posLabel: '是', negLabel: '否' }, { label: 'EMI 增加出國信心 (是/否)', val: 395, total: 471, posLabel: '是', negLabel: '否' }, { label: '有意願海外讀書工作 (是/否)', val: 441, total: 471, posLabel: '是', negLabel: '否' }],
                ratio: [{ name: '教師講授', value: 31 }, { name: '師生互動', value: 22 }, { name: '生生互動', value: 22 }, { name: '學生報告', value: 20 }, { name: '其他', value: 14 }],
                itemScores: [{ name: 'SRL1', score: 3.9 }, { name: 'SRL2', score: 3.3 }, { name: 'SRL3', score: 3.8 }, { name: 'SRL4', score: 4.1 }, { name: 'SRL5', score: 4.1 }, { name: 'CALP1', score: 4.0 }, { name: 'CALP2', score: 4.0 }, { name: 'CALP3', score: 3.9 }, { name: 'CALP4', score: 3.8 }, { name: 'CALP5', score: 4.0 }, { name: 'CALP6', score: 4.0 }, { name: 'Cog1', score: 4.0 }, { name: 'Cog2', score: 4.0 }, { name: 'Cog3', score: 3.9 }, { name: 'Cog4', score: 4.0 }, { name: 'Cog5', score: 4.0 }, { name: 'Cog6', score: 3.9 }, { name: 'Eng1', score: 3.9 }, { name: 'Eng2', score: 3.9 }, { name: 'Eng3', score: 3.9 }, { name: 'Eng4', score: 3.3 }, { name: 'Eng5', score: 3.9 }, { name: 'Eng6', score: 3.9 }, { name: 'Eng7', score: 3.9 }, { name: 'SE1', score: 4.0 }, { name: 'SE2', score: 4.0 }, { name: 'SE3', score: 4.0 }, { name: 'SE4', score: 4.0 }, { name: 'SE5', score: 3.9 }, { name: 'SE6', score: 3.9 }]
            },
            '產創學院': {
                count: 31,
                topKpis: [
                    { label: '有效問卷總數', val: '31', icon: 'users', color: '#8697A8' },
                    { label: '海外讀書/工作意願', val: '26', icon: 'globe', color: '#C49B9B', sub: '占比: 83.9%' },
                    { label: 'EMI 增加出國信心', val: '22', icon: 'smile', color: '#9F97B5', sub: '占比: 71.0%' },
                    { label: '性別分布 (女/男)', val: '5 / 26', icon: 'venusmars', color: '#64748b' }
                ],
                dimensionKpis: [
                    { label: '自我調節學習', val: '3.7', icon: 'target', color: '#8697A8' },
                    { label: '學術英語&學科學習', val: '3.5', icon: 'book', color: '#C49B9B' },
                    { label: 'Bloom認知', val: '3.8', icon: 'brain', color: '#9F97B5' },
                    { label: '課程參與', val: '3.8', icon: 'zap', color: '#C49B9B' },
                    { label: '自我效能', val: '3.8', icon: 'star', color: '#8697A8' }
                ],
                bgStats: [{ label: '生理性別 (女性/男性)', val: 5, total: 31, posLabel: '女性', negLabel: '男性' }, { label: '這是第一次修 EMI (是/否)', val: 18, total: 31, posLabel: '是', negLabel: '否' }, { label: 'EMI 增加出國信心 (是/否)', val: 22, total: 31, posLabel: '是', negLabel: '否' }, { label: '有意願海外讀書工作 (是/否)', val: 26, total: 31, posLabel: '是', negLabel: '否' }],
                ratio: [{ name: '教師講授', value: 39 }, { name: '師生互動', value: 22 }, { name: '生生互動', value: 17 }, { name: '學生報告', value: 15 }, { name: '其他', value: 21 }],
                itemScores: [{ name: 'SRL1', score: 3.7 }, { name: 'SRL2', score: 3.3 }, { name: 'SRL3', score: 3.8 }, { name: 'SRL4', score: 3.8 }, { name: 'SRL5', score: 4.0 }, { name: 'CALP1', score: 3.6 }, { name: 'CALP2', score: 3.5 }, { name: 'CALP3', score: 3.3 }, { name: 'CALP4', score: 3.3 }, { name: 'CALP5', score: 3.5 }, { name: 'CALP6', score: 3.5 }, { name: 'Cog1', score: 4.0 }, { name: 'Cog2', score: 3.8 }, { name: 'Cog3', score: 3.8 }, { name: 'Cog4', score: 3.6 }, { name: 'Cog5', score: 4.0 }, { name: 'Cog6', score: 3.5 }, { name: 'Eng1', score: 4.1 }, { name: 'Eng2', score: 4.0 }, { name: 'Eng3', score: 4.0 }, { name: 'Eng4', score: 3.4 }, { name: 'Eng5', score: 3.4 }, { name: 'Eng6', score: 3.9 }, { name: 'Eng7', score: 3.7 }, { name: 'SE1', score: 3.9 }, { name: 'SE2', score: 3.9 }, { name: 'SE3', score: 3.7 }, { name: 'SE4', score: 3.9 }, { name: 'SE5', score: 3.7 }, { name: 'SE6', score: 3.8 }]
            },
            '通識中心': {
                count: 63,
                topKpis: [
                    { label: '有效問卷總數', val: '63', icon: 'users', color: '#8697A8' },
                    { label: '海外讀書/工作意願', val: '57', icon: 'globe', color: '#C49B9B', sub: '占比: 90.5%' },
                    { label: 'EMI 增加出國信心', val: '51', icon: 'smile', color: '#9F97B5', sub: '占比: 81.0%' },
                    { label: '性別分布 (女/男)', val: '30 / 33', icon: 'venusmars', color: '#64748b' }
                ],
                dimensionKpis: [
                    { label: '自我調節學習', val: '3.9', icon: 'target', color: '#8697A8' },
                    { label: '學術英語&學科學習', val: '4.0', icon: 'book', color: '#C49B9B' },
                    { label: 'Bloom認知', val: '4.0', icon: 'brain', color: '#9F97B5' },
                    { label: '課程參與', val: '3.9', icon: 'zap', color: '#C49B9B' },
                    { label: '自我效能', val: '4.1', icon: 'star', color: '#8697A8' }
                ],
                bgStats: [{ label: '生理性別 (女性/男性)', val: 30, total: 63, posLabel: '女性', negLabel: '男性' }, { label: '這是第一次修 EMI (是/否)', val: 19, total: 63, posLabel: '是', negLabel: '否' }, { label: 'EMI 增加出國信心 (是/否)', val: 51, total: 63, posLabel: '是', negLabel: '否' }, { label: '有意願海外讀書工作 (是/否)', val: 57, total: 63, posLabel: '是', negLabel: '否' }],
                ratio: [{ name: '教師講授', value: 38 }, { name: '師生互動', value: 27 }, { name: '生生互動', value: 27 }, { name: '學生報告', value: 23 }, { name: '其他', value: 22 }],
                itemScores: [{ name: 'SRL1', score: 4.0 }, { name: 'SRL2', score: 3.5 }, { name: 'SRL3', score: 3.7 }, { name: 'SRL4', score: 4.1 }, { name: 'SRL5', score: 4.1 }, { name: 'CALP1', score: 4.1 }, { name: 'CALP2', score: 4.1 }, { name: 'CALP3', score: 4.0 }, { name: 'CALP4', score: 3.9 }, { name: 'CALP5', score: 4.1 }, { name: 'CALP6', score: 3.9 }, { name: 'Cog1', score: 4.0 }, { name: 'Cog2', score: 4.0 }, { name: 'Cog3', score: 4.0 }, { name: 'Cog4', score: 4.1 }, { name: 'Cog5', score: 4.0 }, { name: 'Cog6', score: 4.0 }, { name: 'Eng1', score: 4.1 }, { name: 'Eng2', score: 4.1 }, { name: 'Eng3', score: 4.0 }, { name: 'Eng4', score: 3.5 }, { name: 'Eng5', score: 3.9 }, { name: 'Eng6', score: 4.0 }, { name: 'Eng7', score: 3.9 }, { name: 'SE1', score: 4.1 }, { name: 'SE2', score: 4.2 }, { name: 'SE3', score: 4.1 }, { name: 'SE4', score: 4.3 }, { name: 'SE5', score: 4.0 }, { name: 'SE6', score: 4.1 }]
            }
        };

        const COLLEGE_ORDER = [
            'Overall (全校整體)', '工程學院', '電資學院', '管理學院', '應科學院', '設計學院', '人文學院', '產創學院', '通識中心'
        ];

        const RadarTick = (props) => {
            const { x, y, payload, textAnchor } = props;
            const words = payload.value.split('&');
            return (
                <g transform={`translate(${x},${y})`}>
                    <text x={0} y={0} textAnchor={textAnchor} fill="#334155" style={{ fontSize: '14px', fontWeight: '900' }}>
                        {words.map((word, i) => (
                            <tspan key={i} x={0} dy={i === 0 ? 0 : 18}>{word}{i === 0 && words.length > 1 ? '&' : ''}</tspan>
                        ))}
                    </text>
                </g>
            );
        };

        const RenderRadarLabel = (props) => {
            const { x, y, value } = props;
            return (
                <text x={x} y={y - 12} fill="#000000" textAnchor="middle" style={{ fontSize: '18px', fontWeight: '1000' }}>
                    {value}
                </text>
            );
        };

        function App() {
            const [selectedCollege, setSelectedCollege] = React.useState('Overall (全校整體)');
            const activeData = COLLEGE_DATASET[selectedCollege];
            const radarData = activeData.dimensionKpis.map(d => ({ subject: d.label, A: parseFloat(d.val) }));

            return (
                <div className="max-w-7xl mx-auto p-4 md:p-8 fade-in">
                    <header className="flex flex-col md:flex-row justify-between items-center border-b-2 border-gray-100 pb-6 mb-8 gap-4 text-center md:text-left">
                        <div>
                            <h1 className="text-3xl font-black text-gray-800 tracking-tight">EMI 學生素養分層分析儀表板</h1>
                            <p className="text-gray-500 font-medium mt-1">114.1 學年度 | 當前視角: <span className="text-[#9BADC1] font-bold underline decoration-4 underline-offset-8">{selectedCollege}</span></p>
                        </div>
                        <div className="flex flex-col gap-1 w-full md:w-72">
                            <label className="text-[14px] font-bold text-gray-400 uppercase tracking-widest">切換數據單位</label>
                            <select 
                                className="w-full bg-white border-2 border-[#9BADC1] rounded-xl px-4 py-2 shadow-sm focus:ring-2 focus:ring-[#9BADC1] outline-none font-black text-gray-700 transition-all cursor-pointer text-xl"
                                value={selectedCollege}
                                onChange={(e) => setSelectedCollege(e.target.value)}
                            >
                                {COLLEGE_ORDER.map(name => <option key={name} value={name}>{name}</option>)}
                            </select>
                        </div>
                    </header>

                    {/* 第一排 KPI: 基礎統計 */}
                    <div className="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        {activeData.topKpis.map((kpi, idx) => (
                            <div key={idx} className="bg-white border rounded-2xl p-5 shadow-sm border-t-4" style={{ borderTopColor: kpi.color }}>
                                <div className="flex items-center gap-3 mb-2">
                                    <SimpleIcon name={kpi.icon} color={kpi.color} />
                                    <span className="text-[14px] font-black text-gray-500 uppercase tracking-tight leading-tight">{kpi.label}</span>
                                </div>
                                <p className="text-3xl font-black text-gray-800 tracking-tighter">{kpi.val}</p>
                                {kpi.sub && <p className="text-[12px] font-bold text-gray-400 mt-1">{kpi.sub}</p>}
                            </div>
                        ))}
                    </div>

                    {/* 第二排 KPI: 各素養構面平均值 (全底色，顏色循環為 藍-紅-紫-紅-藍) */}
                    <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-10">
                        {activeData.dimensionKpis.map((kpi, idx) => (
                            <div key={idx} className="border rounded-xl p-5 shadow-lg transition-transform hover:scale-105" style={{ backgroundColor: kpi.color }}>
                                <div className="flex items-center gap-2 mb-2">
                                    <SimpleIcon name={kpi.icon} color="white" size={22} />
                                    <span className="text-[15px] font-black text-white opacity-95 uppercase leading-tight">{kpi.label}</span>
                                </div>
                                <p className="text-5xl font-black text-white">{kpi.val}</p>
                                <div className="w-full bg-white bg-opacity-20 h-3 mt-3 rounded-full overflow-hidden">
                                    <div className="h-full bg-white opacity-60" style={{ width: `${(parseFloat(kpi.val)/5)*100}%` }}></div>
                                </div>
                            </div>
                        ))}
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-10 mb-10">
                        {/* 背景分布 */}
                        <div className="bg-white p-8 rounded-3xl shadow-sm border border-gray-100">
                            <h3 className="text-2xl font-black text-gray-700 mb-8 border-l-8 border-[#9BADC1] pl-4">學員背景資料分佈 (N={activeData.count})</h3>
                            <div className="space-y-12">
                                {activeData.bgStats.map((item, i) => {
                                    const pct = (item.val / item.total) * 100;
                                    return (
                                        <div key={i}>
                                            <p className="text-lg font-black text-gray-600 mb-3">{item.label}</p>
                                            <div className="bg-stats-bar shadow-inner">
                                                <div className="bg-stats-segment" style={{ width: `${pct}%`, backgroundColor: '#9BADC1' }}>{item.val}</div>
                                                <div className="bg-stats-segment" style={{ width: `${100 - pct}%`, backgroundColor: '#cbd5e1', color: '#1e293b' }}>{item.total - item.val}</div>
                                            </div>
                                            <div className="flex justify-between text-sm text-gray-400 mt-2 font-black italic text-[14px]">
                                                <span>{item.posLabel}</span>
                                                <span>{item.negLabel}</span>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>

                        {/* 雷達圖 */}
                        <div className="bg-white p-8 rounded-3xl shadow-sm border border-gray-100 flex flex-col items-center">
                            <h3 className="text-2xl font-black text-gray-700 mb-8 text-center">{selectedCollege} 素養評分雷達</h3>
                            <div className="h-96 w-full">
                                <ResponsiveContainer width="100%" height="100%">
                                    <RadarChart cx="50%" cy="50%" outerRadius="80%" data={radarData}>
                                        <PolarGrid stroke="#cbd5e1" strokeWidth={1} />
                                        <PolarAngleAxis dataKey="subject" tick={<RadarTick />} />
                                        <PolarRadiusAxis angle={30} domain={[0, 5]} tick={false} axisLine={false} />
                                        <Radar name={selectedCollege} dataKey="A" stroke="#9BADC1" fill="#9BADC1" fillOpacity={0.6}>
                                            <LabelList dataKey="A" content={RenderRadarLabel} />
                                        </Radar>
                                        <Tooltip />
                                    </RadarChart>
                                </ResponsiveContainer>
                            </div>
                        </div>
                    </div>

                    {/* 教學占比 */}
                    <div className="bg-white p-10 rounded-3xl shadow-sm border border-gray-100 mb-10">
                        <h3 className="text-3xl font-black text-gray-700 mb-12 text-center uppercase tracking-widest">EMI 課堂教學活動占比分布 (%)</h3>
                        <div className="h-96">
                            <ResponsiveContainer width="100%" height="100%">
                                <BarChart data={activeData.ratio} layout="vertical" margin={{ left: 20, right: 100 }}>
                                    <CartesianGrid strokeDasharray="3 3" horizontal={true} vertical={false} stroke="#eee" />
                                    <XAxis type="number" domain={[0, 60]} hide />
                                    <YAxis dataKey="name" type="category" tick={{fontSize: 18, fontWeight: '1000', fill: '#334155'}} width={120} />
                                    <Tooltip />
                                    <Bar dataKey="value" radius={[0, 20, 20, 0]} barSize={60}>
                                        {activeData.ratio.map((entry, index) => (
                                            <Cell key={`cell-${index}`} fill={index === 0 ? '#9BADC1' : index % 2 === 0 ? '#B9B1D2' : '#E2B4BD'} />
                                        ))}
                                        <LabelList dataKey="value" position="right" formatter={(v) => `${v}%`} style={{ fontSize: '24px', fontWeight: '1000', fill: '#000' }} />
                                    </Bar>
                                </BarChart>
                            </ResponsiveContainer>
                        </div>
                    </div>

                    {/* 30 項趨勢圖 */}
                    <div className="bg-white border rounded-3xl p-8 shadow-sm mb-10">
                        <h3 className="text-2xl font-black text-gray-700 mb-8 border-l-8 border-[#B9B1D2] pl-4">30 項測量細項詳細平均分趨勢</h3>
                        <div className="h-80">
                            <ResponsiveContainer width="100%" height="100%">
                                <ComposedChart data={activeData.itemScores}>
                                    <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f1f5f9" />
                                    <XAxis dataKey="name" tick={{ fontSize: 11, fontWeight: '900' }} interval={0} />
                                    <YAxis domain={[0, 5]} tick={{fontSize: 14, fontWeight: '900'}} />
                                    <Tooltip />
                                    <Bar dataKey="score" fill="#E2B4BD" barSize={16} radius={[4, 4, 0, 0]} opacity={0.8} />
                                    <Line type="monotone" dataKey="score" stroke="#B9B1D2" dot={{ r: 4, fill: '#B9B1D2' }} strokeWidth={4} />
                                </ComposedChart>
                            </ResponsiveContainer>
                        </div>
                    </div>

                    {/* 教學策略連結 */}
                    <div className="mt-16 text-center">
                        <a 
                            href="https://sites.google.com/view/ntustemihelp/%E6%95%99%E5%AD%B8%E7%AD%96%E7%95%A5%E6%8E%A8%E8%96%A6" 
                            target="_blank" 
                            rel="noopener noreferrer"
                            className="inline-flex items-center gap-3 px-10 py-5 bg-[#8697A8] text-white rounded-full font-black text-xl hover:bg-[#6e7d8c] transition-all shadow-md hover:shadow-2xl transform hover:-translate-y-1"
                        >
                            <SimpleIcon name="globe" color="white" size={24} />
                            前往：EMI 教學策略推薦 (教學支援網)
                        </a>
                    </div>

                    <footer className="mt-12 pt-8 border-t-4 border-gray-100 text-center text-xs font-black text-gray-300 uppercase tracking-[0.6em]">
                        {selectedCollege} FACETED DATA DASHBOARD | FACILITATED BY RECHARTS & GEMINI 2.5
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
